<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox spacing="10" xmlns:fx="http://javafx.com/fxml"
      fx:controller="orhestra.coordinator.ui.ExecutionController"
      styleClass="pad">

    <!-- Stats header: task counters -->
    <HBox spacing="12" alignment="CENTER_LEFT" styleClass="stats-bar">
        <Label text="Execution" styleClass="section-header"/>
        <Region HBox.hgrow="ALWAYS"/>
        <VBox alignment="CENTER" spacing="1">
            <Label fx:id="lblNew" text="0" styleClass="stat-value"/>
            <Label text="Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸" styleClass="stat-label"/>
        </VBox>
        <VBox alignment="CENTER" spacing="1">
            <Label fx:id="lblRunning" text="0" styleClass="stat-value"/>
            <Label text="Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚" styleClass="stat-label"/>
        </VBox>
        <VBox alignment="CENTER" spacing="1">
            <Label fx:id="lblDone" text="0" styleClass="stat-value"/>
            <Label text="Ð³Ð¾Ñ‚Ð¾Ð²Ð¾" styleClass="stat-label"/>
        </VBox>
        <VBox alignment="CENTER" spacing="1">
            <Label fx:id="lblFailed" text="0" styleClass="stat-value"/>
            <Label text="Ð¾ÑˆÐ¸Ð±ÐºÐ¸" styleClass="stat-label"/>
        </VBox>
    </HBox>

    <!-- SPOT Workers cards -->
    <TitledPane text="SPOT Workers" expanded="true" animated="true">
        <VBox spacing="6">
            <padding><Insets top="6" right="6" bottom="6" left="6"/></padding>
            <ScrollPane fitToHeight="true" prefHeight="100" hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                        styleClass="spots-scroll">
                <FlowPane fx:id="spotCards" hgap="8" vgap="8" prefWrapLength="2000"/>
            </ScrollPane>
            <Label fx:id="lblSpotCount" text="Spots: 0" styleClass="muted"/>
        </VBox>
    </TitledPane>

    <!-- Simulation controls -->
    <TitledPane text="Simulation" expanded="false" animated="true">
        <VBox spacing="8">
            <padding><Insets top="8" right="8" bottom="8" left="8"/></padding>
            <HBox spacing="12" alignment="CENTER_LEFT">
                <Label text="Workers:" prefWidth="80"/>
                <Spinner fx:id="simWorkers" prefWidth="90" editable="true"/>
                <Label text="Delay ms:" prefWidth="70"/>
                <TextField fx:id="simDelayMin" prefWidth="60" promptText="200"/>
                <Label text="â€”"/>
                <TextField fx:id="simDelayMax" prefWidth="60" promptText="1200"/>
                <Label text="Fail rate:" prefWidth="65"/>
                <TextField fx:id="simFailRate" prefWidth="55" promptText="0.0"/>
            </HBox>
            <HBox spacing="8">
                <Button fx:id="btnStartSim" text="â–¶ Start simulation" onAction="#handleStartSim"
                        styleClass="btn-primary"/>
                <Button fx:id="btnStopSim" text="â–  Stop simulation" onAction="#handleStopSim"
                        styleClass="btn-danger" disable="true"/>
            </HBox>
        </VBox>
    </TitledPane>

    <!-- JSON Files -->
    <TitledPane text="Ð¤Ð°Ð¹Ð»Ñ‹ Ð·Ð°Ð´Ð°Ñ‡ (JSON)" expanded="false" animated="true">
        <VBox spacing="6">
            <padding><Insets top="6" right="6" bottom="6" left="6"/></padding>
            <HBox spacing="8" alignment="CENTER_LEFT">
                <ComboBox fx:id="recentJsonCombo" prefWidth="300" promptText="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ JSON Ñ„Ð°Ð¹Ð»â€¦"/>
                <Button text="âœ•" onAction="#handleRemoveJson" styleClass="btn-danger" prefWidth="28"/>
                <Button text="ðŸ—‘" onAction="#handleClearJson" styleClass="btn-danger" prefWidth="28"/>
            </HBox>
            <HBox spacing="8">
                <Button text="Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ JSONâ€¦" onAction="#onAddJsonFile" styleClass="btn-primary"/>
                <Button text="Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹" onAction="#handleLoadSelectedJson" styleClass="btn-primary"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ" onAction="#refreshTasks" styleClass="btn-primary"/>
            </HBox>
        </VBox>
    </TitledPane>

    <!-- Task Table -->
    <TableView fx:id="taskTable" VBox.vgrow="ALWAYS">
        <placeholder>
            <Label text="Ð—Ð°Ð´Ð°Ñ‡ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚. Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ JSON Ð¸Ð»Ð¸ Ð´Ð¾Ð¶Ð´Ð¸Ñ‚ÐµÑÑŒ Ð·Ð°Ð´Ð°Ñ‡ Ð¾Ñ‚ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ð¾Ñ€Ð°."
                   styleClass="muted" style="-fx-font-size: 14;"/>
        </placeholder>
        <columns>
            <TableColumn fx:id="idColumn"        text="ID"        prefWidth="120"/>
            <TableColumn fx:id="algColumn"       text="ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼"  prefWidth="80"/>
            <TableColumn fx:id="funcColumn"      text="Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ"   prefWidth="90"/>
            <TableColumn fx:id="iterColumn"      text="Ð˜Ñ‚ÐµÑ€Ð°Ñ†Ð¸Ð¸"  prefWidth="65"/>
            <TableColumn fx:id="agentsColumn"    text="ÐÐ³ÐµÐ½Ñ‚Ñ‹"    prefWidth="55"/>
            <TableColumn fx:id="dimensionColumn" text="Ð Ð°Ð·Ð¼ÐµÑ€Ð½."  prefWidth="65"/>
            <TableColumn fx:id="spotIdColumn"    text="Spot"      prefWidth="80"/>
            <TableColumn fx:id="runtimeColumn"   text="Ð’Ñ€ÐµÐ¼Ñ"     prefWidth="80"/>
            <TableColumn fx:id="statusColumn"    text="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"    prefWidth="90"/>
            <TableColumn fx:id="progressColumn"  text="ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ"  prefWidth="80"/>
        </columns>
    </TableView>
</VBox>
